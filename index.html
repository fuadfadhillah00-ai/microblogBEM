<!-- Tempelkan kode ini via Insert → Embed → Embed Code di Google Sites -->

<div id="blog-cards-container" style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;"></div>

<script>
(async function() {
  const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTdEO3PL-f305V0eTt3jn5aH0HkzsOm5qJZhgW2pzfiPjAOrCNyYPe3r3ffmDW0LKQNyXq6mdDn4BXI/pub?gid=0&single=true&output=csv";
  
  try {
    const response = await fetch(csvUrl);
    if (!response.ok) {
      throw new Error("Gagal mengambil data: HTTP " + response.status);
    }
    const text = await response.text();
    const rows = text.trim().split("\n").map(r => r.split(","));
    
    const header = rows[0];
    const idxTitle = header.indexOf("Judul");
    const idxSnippet = header.indexOf("Cuplikan");
    const idxLink = header.indexOf("Link");
    const idxImage = header.indexOf("Gambar");
    
    if (idxTitle < 0 || idxSnippet < 0 || idxLink < 0) {
      console.error("Kolom 'Judul', 'Cuplikan', atau 'Link' tidak ditemukan.");
      return;
    }
    
    const items = rows.slice(1).map(c => ({
      title: c[idxTitle],
      snippet: c[idxSnippet],
      link: c[idxLink],
      image: idxImage >= 0 ? c[idxImage] : null
    }));
    
    const latest = items.slice(-3).reverse();
    const container = document.getElementById("blog-cards-container");
    
    latest.forEach(item => {
      const card = document.createElement("div");
      card.style = "width: 30%; min-width: 200px; border: 1px solid #ddd; border-radius: 10px; padding: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); display: flex; flex-direction: column;";
      
      if (item.image) {
        const img = document.createElement("img");
        img.src = item.image;
        img.alt = item.title;
        img.style = "width:100%; height:auto; border-radius: 10px; object-fit: cover; margin-bottom:10px;";
        card.appendChild(img);
      }
      
      const h3 = document.createElement("h3");
      h3.textContent = item.title;
      card.appendChild(h3);
      
      const p = document.createElement("p");
      p.textContent = item.snippet;
      card.appendChild(p);
      
      const a = document.createElement("a");
      a.href = item.link;
      a.textContent = "Baca Selengkapnya";
      a.target = "_blank";
      a.style = "margin-top: auto; color: #1a73e8; text-decoration: none;";
      card.appendChild(a);
      
      container.appendChild(card);
    });
    
  } catch (error) {
    console.error("Error:", error);
    const c = document.getElementById("blog-cards-container");
    c.textContent = "Gagal memuat posting terbaru.";
  }
})();
</script>
